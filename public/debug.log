<?php
// www/public/debug.php
error_reporting(E_ALL);
ini_set('display_errors', 1);
ini_set('log_errors', 1);
ini_set('error_log', __DIR__ . '/../logs/debug.log');

echo "<h1>Informations de Debug</h1>";
echo "<h2>PHP Version : " . PHP_VERSION . "</h2>";
echo "<h2>Extensions chargées :</h2>";
echo "<pre>" . print_r(get_loaded_extensions(), true) . "</pre>";

echo "<h2>Configuration PHP :</h2>";
echo "<pre>" . print_r(ini_get_all(), true) . "</pre>";

echo "<h2>Vérification des fichiers requis :</h2>";
 $required_files = [
    '../includes/config.php',
    '../core/Database.php',
    '../core/Session.php',
    '../vendor/autoload.php'
];

foreach ($required_files as $file) {
    $exists = file_exists($file) ? "✅" : "❌";
    echo "$exists $file<br>";
}

echo "<h2>Test de connexion BDD :</h2>";
try {
    if (file_exists('../includes/config.php')) {
        require_once '../includes/config.php';
        $pdo = new PDO("mysql:host=" . DB_HOST . ";dbname=" . DB_NAME, DB_USER, DB_PASS);
        echo "✅ Connexion BDD réussie";
    } else {
        echo "❌ Fichier config.php non trouvé";
    }
} catch (Exception $e) {
    echo "❌ Erreur BDD : " . $e->getMessage();
}
?>